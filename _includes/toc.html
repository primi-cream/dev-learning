{% if site.toc and site.toc.enabled %}
<div class="book-toc">
  <div class="book-toc-content">
    <ul class="sidebar-navigation">
      {%- assign categories = "" | split: "," -%}
      {%- for post in site.posts -%}
        {%- assign category = post.categories | first -%}
        {%- unless categories contains category -%}
          {%- assign categories = categories | push: category -%}
        {%- endunless -%}
      {%- endfor -%}

      {%- for category in categories -%}
        <li>
          <a href="javascript:void(0)" class="category-toggle"><strong>{{ category }}</strong></a>
          <ul class="category-posts" style="display: none;">
            {%- for post in site.posts -%}
              {%- if post.categories contains category -%}
                <li>
                  <a href="{{ post.url | relative_url }}">{{ post.title }}</a>
                </li>
              {%- endif -%}
            {%- endfor -%}
          </ul>
        </li>
      {%- endfor -%}
    </ul>
  </div>
</div>

<script>
  document.addEventListener("DOMContentLoaded", function () {
    document.querySelectorAll(".category-toggle").forEach(function (el) {
      el.addEventListener("click", function () {
        var nextEl = this.nextElementSibling;
        if (nextEl.style.display === "none" || nextEl.style.display === "") {
          nextEl.style.display = "block";
        } else {
          nextEl.style.display = "none";
        }
      });
    });
  });
</script>
{% endif %}
